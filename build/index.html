<!DOCTYPE html>
<html moznomarginboxes mozdisallowselectionprint>

<head>
    <title>Quodd Web Agreements</title>
    <link rel="shortcut icon" type="image/x-icon" href="favicon.ico" />
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="//ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="//ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular.min.js"></script>
    <script src="//angular-ui.github.io/ui-router/release/angular-ui-router.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/angular-base64/2.0.5/angular-base64.min.js"></script>
    <script type="text/javascript">
        angular.module("quoddAgreementApp", ['ui.router', 'base64'])
            .config(function ($stateProvider, $urlRouterProvider, $base64, $httpProvider) {
                //remove this once the headers are fixed in all the calls.
                var auth = $base64.encode("quoddvordev:ondemandvordev");
                $httpProvider.defaults.headers.common['Authorization'] = 'Basic ' + auth;
               
                $urlRouterProvider.otherwise("/firmLogin");
                $stateProvider
                    .state('firmLogin', {
                        url: "/firmLogin",
                        templateUrl: "firmLogin.html"
                    })
                    .state('/:firm', {
                        url: "/:firm",
                        templateUrl: "LoginScreen.html"
                    })
                    .state('/:firm/:ID', {
                        url: "/:firm/:ID",
                        templateUrl: "LoginScreen.html"
                    })
                    .state('LoginScreen', {
                        templateUrl: "LoginScreen.html"
                    })
                    .state('declaration', {
                        templateUrl: "declarationScreen.html"
                    })
                    .state('proDeclaration', {
                        templateUrl: "proDeclarationScreen.html"
                    })
                    .state('information', {
                        templateUrl: "subscriberInformation.html"
                    })
                    .state('agreementFilled', {
                        templateUrl: "NasdaqAgreementFilled.html"
                    })
                    .state('nasdaqAgreement', {
                        templateUrl: "nasdaqAgreement.html"
                    })
                    .state('nyseAgreement', {
                        templateUrl: "NYSEAgreement.html"
                    })
                    .state('marketDataAgreement', {
                        templateUrl: "markeDataAgreement.html"
                    })
                    .state('marketDataSubscriberAgreement', {
                        templateUrl: "marketDataSubscriberAgreement.html"
                    })
                    .state('marketDataSubscriberAgreementFilled', {
                        templateUrl: "marketDataSubscriberAgreementFilled.html"
                    })
                    .state('batScreen', {
                        templateUrl: "batsScreen.html"
                    })
                    .state('batScreenFilled', {
                        templateUrl: "batsScreenFilled.html"
                    })
                    .state('Opra', {
                        templateUrl: "opraScreen.html"
                    })
                    .state('OpraFilled', {
                        templateUrl: "opraScreenFilled.html"
                    })
                    .state('cme', {
                        templateUrl: "CMEScreen.html"
                    })
                    .state('cmeFilled', {
                        templateUrl: "CMEScreenFilled.html"
                    })
                    .state('finish', {
                        templateUrl: "endPage.html"
                    })
                    .state('TSX', {
                        templateUrl: "TSXAgreement.html"
                    })
                    .state('TSXFilled', {
                        templateUrl: "TSXAgreementFIlled.html"
                    })
                    .state('CTA',{
                        templateUrl:"CTAScreen.html"
                    })
                    .state('CTAFilled',{
                        templateUrl:"CTAScreenFilled.html"
                    })
                    .state('opraPro',{
                        templateUrl:"opraPro.html"
                    })
                    .state('opraProFilled',{
                        templateUrl:"opraProFilled.html"
                    });
            })
            .factory('myService', function ($http, $rootScope, $base64) {
                return {
                    checkUser: function () {
                        $rootScope.headers = {
                            "firm_code": $rootScope.firmcode,
                            "token": $rootScope.token
                        };
                        return $http.get("//www6.quodd.com/vor/quodd/app/user/agreement/detail", {
                            headers: $rootScope.headers
                        });
                    }
                };
            })
            .factory('firmDetailsService', function ($http, $rootScope, $base64) {
                return {
                    getFirmDetails: function () {
                        var headers = {
                            "firm_code": $rootScope.firmcode
                        };
                        return $http.get("//www6.quodd.com/vor/quodd/app/firm/detail", {
                            headers: headers
                        });
                    }
                };
            })
            .factory('firmListService', function ($http) {
                return {
                    getFirmNames: function () {
                        var headers = {
                            "firm_code": "quodd"
                        };
                        return $http.get("//www6.quodd.com/vor/quodd/app/vorlist", {
                            headers: headers
                        });
                    }
                };
            })
            .controller("quoddAgreementController", function ($scope, $location, $http, $rootScope, myService, $state, $stateParams, $base64, firmDetailsService, firmListService) {

                $scope.RetiredOrEmplyedStatus = 'false';
                $scope.date = new Date();
                $rootScope.date = $scope.date;
                $scope.optradiomarketDataSubscriber = $rootScope.proUserCheck ? "true":"false";   //status of pro in case of OTC agreement
                $scope.optradiomarketDataSubscriber1 =!$rootScope.proUserCheck ? "true":"false";   //status of non-pro in case of OTC agreement
                $scope.maketDataAgreementNextStatus = true;
                $rootScope.NYSEradio1 = "true";  //personal or non-business use
                $rootScope.NYSEradio2 = "false";

                var urlArr = $location.absUrl().split("#/");
                $scope.company = urlArr[1];

                if ($scope.company === 'firmLogin' && $rootScope.companyOptions === undefined) {
                    firmListService.getFirmNames()
                        .then(function (response) {
                            $rootScope.companyOptions = response.data;
                            $scope.selectedCompany = $rootScope.companyOptions[0].firm_code;
                            $rootScope.firmcode = $scope.selectedCompany;
                        });
                }

                $scope.changeFirmName = function (name) {
                    $scope.selectedCompany = name;
                    $rootScope.firmcode = name;
                };

                $scope.proceedToGetFirmDetail = function () {
                    firmDetailsService.getFirmDetails()
                        .then(function (response) {
                            $rootScope.firmcode = response.data.firm_code;
                            $rootScope.appName = response.data.agreement_app_name;
                            $rootScope.authtype = response.data.auth_type;
                            $rootScope.firmMail = response.data.agreement_support_email;
                            $rootScope.firmName = response.data.firm_name;
                            $rootScope.agreementfirmname = response.data.agreement_firm_name;
                            $rootScope.firm_id = response.data.firm_id;
                            $rootScope.is_quodd_vor = response.data.is_quodd_vor;
                            $state.go('LoginScreen');
                        });
                };

                if ($stateParams.firm) {
                    // console.log("In $stateParams" + $stateParams.firm);
                    $rootScope.firmcode = $stateParams.firm;
                    firmDetailsService.getFirmDetails()
                        .then(function (response) {
                            $rootScope.firmcode = response.data.firm_code;
                            $rootScope.appName = response.data.agreement_app_name;
                            $rootScope.authtype = response.data.auth_type;
                            $rootScope.firmMail = response.data.agreement_support_email;
                            $rootScope.firmName = response.data.firm_name;
                            $rootScope.agreementfirmname = response.data.agreement_firm_name;
                            $rootScope.firm_id = response.data.firm_id;
                            $rootScope.is_quodd_vor = response.data.is_quodd_vor;
                        });
                }

                if ($stateParams.ID) {
                    // console.log("In $stateParams" + $stateParams.ID);
                    $scope.callSupportingAPI = true;
                    $rootScope.token = $stateParams.ID;
                    var userName = $rootScope.token;
                    $scope.loginWithUsername(userName);
                }

                var loginWithUsername = function (userName) {
                    $rootScope.countryArray = [
                        "United States", "Afghanistan", "Akrotiri", "Albania", "Algeria", "American Samoa",
                        "Andorra", "Angola", "Anguilla", "Antarctica", "Antigua", " and Barbuda", "Argentina", "Armenia", "Aruba",
                        "Ashmore and Cartier Islands", "Australia", "Austria", "Azerbaijan", "Bahamas, The", "Bahrain",
                        "Bangladesh", "Barbados", "Bassas da India", "Belarus", "Belgium", "Belize", "Benin", "Bermuda", "Bhutan",
                        "Bolivia", "Bosnia and Herzegovina", "Botswana", "Bouvet Island", "Brazil",
                        "British Indian Ocean Territory", "British Virgin Islands", "Brunei", "Bulgaria", "Burkina Faso",
                        "Burma", "Burundi", "Cambodia", "Cameroon", "Canada", "Cape Verde", "Cayman Islands",
                        "Central African Republic", "Chad", "Chile", "China", "Christmas Island", "Clipperton Island",
                        "Cocos (Keeling) Islands", "Colombia", "Comoros", "Congo, Democratic Republic of the",
                        "Congo, Republic of the", "Cook Islands", "Coral Sea Islands", "Costa Rica",
                        "Cote d'Ivoire", "Croatia", "Cuba", "Cyprus", "Czech Republic", "Denmark", "Dhekelia",
                        "Djibouti", "Dominica", "Dominican Republic", "Ecuador", "Egypt", "El Salvador", "Equatorial Guinea",
                        "Eritrea", "Estonia", "Ethiopia", "Europa Island", "Falkland Islands (Islas Malvinas)",
                        "Faroe Islands", "Fiji", "Finland", "France", "French Guiana", "French Polynesia",
                        "French Southern and Antarctic Lands", "Gabon", "Gambia, The", "Gaza Strip", "Georgia",
                        "Germany", "Ghana", "Gibraltar", "Glorioso Islands", "Greece", "Greenland", "Grenada", "Guadeloupe",
                        "Guam", "Guatemala", "Guernsey", "Guinea", "Guinea-Bissau", "Guyana", "Haiti",
                        "Heard Island and McDonald Islands", "Holy See (Vatican City)", "Honduras", "Hong Kong",
                        "Hungary", "Iceland", "India", "Indonesia", "Iran", "Iraq", "Ireland", "Isle of Man", "Israel",
                        "Italy", "Jamaica", "Jan Mayen", "Japan", "Jersey", "Jordan", "Juan de Nova Island", "Kazakhstan",
                        "Kenya", "Kiribati", "Korea, North", "Korea, South", "Kuwait", "Kyrgyzstan", "Laos", "Latvia",
                        "Lebanon", "Lesotho", "Liberia", "Libya", "Liechtenstein", "Lithuania", "Luxembourg", "Macau", "Macedonia",
                        "Madagascar", "Malawi", "Malaysia", "Maldives", "Mali", "Malta", "Marshall Islands", "Martinique",
                        "Mauritania", "Mauritius", "Mayotte", "Mexico", "Micronesia, Federated States of", "Moldova", "Monaco",
                        "Mongolia", "Montserrat", "Morocco", "Mozambique", "Namibia", "Nauru", "Navassa Island", "Nepal",
                        "Netherlands", "Netherlands Antilles", "New Caledonia", "New Zealand", "Nicaragua", "Niger", "Nigeria",
                        "Niue", "Norfolk Island", "Northern Mariana Islands", "Norway", "Oman", "Pakistan", "Palau", "Panama",
                        "Papua New Guinea", "Paracel Islands", "Paraguay", "Peru", "Philippines", "Pitcairn Islands", "Poland",
                        "Portugal", "Puerto Rico", "Qatar", "Reunion", "Romania", "Russia", "Rwanda", "Saint Helena",
                        "Saint Kitts and Nevis", "Saint Lucia", "Saint Pierre and Miquelon",
                        "Saint Vincent and the Grenadines", "Samoa", "San Marino", "Sao Tome and Principe", "Saudi Arabia",
                        "Senegal", "Serbia and Montenegro", "Seychelles", "Sierra Leone", "Singapore", "Slovakia", "Slovenia",
                        "Solomon Islands", "Somalia", "South Africa", "South Georgia and the South Sandwich Islands",
                        "Spain", "Spratly Islands", "Sri Lanka", "Sudan", "Suriname", "Svalbard", "Swaziland", "Sweden",
                        "Switzerland", "Syria", "Taiwan", "Tajikistan", "Tanzania", "Thailand", "Timor-Leste", "Togo", "Tokelau",
                        "Tonga", "Trinidad and Tobago", "Tromelin Island", "Tunisia", "Turkey", "Turkmenistan", "Turks and Caicos Islands",
                        "Tuvalu", "Uganda", "Ukraine", "United Arab Emirates", "United Kingdom", "Uruguay",
                        "Uzbekistan", "Vanuatu", "Venezuela", "Vietnam", "Virgin Islands", "Wake Island", "Wallis and Futuna",
                        "West Bank", "Western Sahara", "Yemen", "Zambia", "Zimbabwe"
                    ];

                    $rootScope.stateArray = {
                        "AL": "Alabama",
                        "AK": "Alaska",
                        "AZ": "Arizona",
                        "AR": "Arkansas",
                        "CA": "California",
                        "CO": "Colorado",
                        "CT": "Connecticut",
                        "DE": "Delaware",
                        "DC": "District of Columbia",
                        "FL": "Florida",
                        "GA": "Georgia",
                        "HI": "Hawaii",
                        "ID": "Idaho",
                        "IL": "Illinois",
                        "IN": "Indiana",
                        "IA": "Iowa",
                        "KS": "Kansas",
                        "KY": "Kentucky",
                        "LA": "Louisiana",
                        "ME": "Maine",
                        "MD": "Maryland",
                        "MA": "Massachusetts",
                        "MI": "Michigan",
                        "MN": "Minnesota",
                        "MS": "Mississippi",
                        "MO": "Missouri",
                        "MT": "Montana",
                        "NE": "Nebraska",
                        "NV": "Nevada",
                        "NH": "New Hampshire",
                        "NJ": "New Jersey",
                        "NM": "New Mexico",
                        "NY": "New York",
                        "NC": "North Carolina",
                        "ND": "North Dakota",
                        "OH": "Ohio",
                        "OK": "Oklahoma",
                        "OR": "Oregon",
                        "PA": "Pennsylvania",
                        "RI": "Rhode Island",
                        "SC": "South Carolina",
                        "SD": "South Dakota",
                        "TN": "Tennessee",
                        "TX": "Texas",
                        "UT": "Utah",
                        "VT": "Vermont",
                        "VA": "Virginia",
                        "VI": "Virgin Islands",
                        "WA": "Washington",
                        "WV": "West Virginia",
                        "WI": "Wisconsin",
                        "WY": "Wyoming",
                        "AB": "Alberta",
                        "BC": "British Columbia",
                        "MB": "Manitoba",
                        "NB": "New Brunswick",
                        "NL": "Newfoundland",
                        "NT": "Northwest Territories",
                        "NS": "Nova Scotia",
                        "NU": "Nunavut",
                        "ON": "Ontario",
                        "PE": "Prince Edward Island",
                        "QC": "Quebec",
                        "SK": "Saskatchewan",
                        "YT": "Yukon",
                        "Other": "Other (Not in US or Canada)"
                    };
                    if (userName !== "" && userName !== undefined) {
                        $rootScope.token = userName;
                        document.getElementById("overlay").style.display = "block";
                        myService.checkUser()
                            .then(function (response) {
                                $scope.myDetails = response.data;
                                $scope.agreementExchangeSet = $scope.myDetails.agreements;
                                //name to be shown on top right corner, this is done specially for tokens
                                $rootScope.user_name = $scope.myDetails.user_name;
                                $scope.user_type = $scope.myDetails.user_type;
                                $rootScope.exchange_id = $scope.myDetails.exchange_id;
                                //true means pro, false means non pro
                                if ($scope.user_type === 1){
                                    $rootScope.proUserCheck = true;
                                    $scope.user_type = true;
                                }                                    
                                else{
                                    $rootScope.proUserCheck = false;
                                    $scope.user_type = false;
                                }
                                $scope.redirect_app = $scope.myDetails.redirect_app;
                                $scope.status = $scope.myDetails.status;
                                $scope.first_name=$scope.myDetails.first_name;
                                //setting flags starts
                                if ($scope.agreementExchangeSet.indexOf(1) > -1)
                                    $rootScope.showNYSE = true;
                                else
                                    $rootScope.showNYSE = false;
                                if ($scope.agreementExchangeSet.indexOf(2) > -1)
                                    $rootScope.showNASDAQ = true;
                                else
                                    $rootScope.showNASDAQ = false;
                                if ($scope.agreementExchangeSet.indexOf(3) > -1)
                                    $rootScope.showOTC = true;
                                else
                                    $rootScope.showOTC = false;
                                if ($scope.agreementExchangeSet.indexOf(4) > -1)
                                    $rootScope.showOPRA = true;
                                else
                                    $rootScope.showOPRA = false;
                                if ($scope.agreementExchangeSet.indexOf(5) > -1)
                                    $rootScope.showBATS = true;
                                else
                                    $rootScope.showBATS = false;
                                if ($scope.agreementExchangeSet.indexOf(6) > -1)
                                    $rootScope.showCME = true;
                                else
                                    $rootScope.showCME = false;
                                if ($scope.agreementExchangeSet.indexOf(7) > -1)
                                    $rootScope.showTSX = true;
                                else
                                    $rootScope.showTSX = false;
                                if($scope.agreementExchangeSet.indexOf(9) > -1)
                                    $rootScope.showOPRApro = true;
                                else
                                    $rootScope.showOPRApro = false;
                                if($scope.agreementExchangeSet.indexOf(10) > -1)
                                    $rootScope.showCTA = true;
                                else
                                    $rootScope.showCTA = false;
                                if($scope.agreementExchangeSet.indexOf(11) > -1)
                                    $rootScope.showNASDAQpro = true;
                                else
                                    $rootScope.showNASDAQpro = false;
                                if($scope.agreementExchangeSet.indexOf(12) > -1)
                                    $rootScope.showOTCpro = true;
                                else
                                    $rootScope.showOTCpro = false;
                                $rootScope.NYSEradio1 = "";
                                $rootScope.NYSEradio2 = "";
                                $rootScope.FirstName = "";
                                $rootScope.LastName = "";
                                $rootScope.AddressLine1 = "";
                                $rootScope.AddressLine2 = "";
                                $rootScope.City = "";
                                $rootScope.State = "";
                                $rootScope.Country = "";
                                $rootScope.Zip = "";
                                $rootScope.PhoneNumber = "";
                                $rootScope.Email = "";
                                $rootScope.Occupation = "";
                                $rootScope.Title = "";
                                $rootScope.Employer = "";
                                $rootScope.EmployerAddress = "";
                                $rootScope.EmployerCity = "";
                                $rootScope.EmployerState = "";
                                $rootScope.EmployerZip = "";
                                $rootScope.EmployerCountry = "";
                                $rootScope.RetiredOrEmplyedStatus = "";
                                $rootScope.EmploymentFunctionEmployer = "";
                                if ($scope.redirect_app === false) {
                                    document.getElementById("overlay").style.display = "none";
                                    $state.go('finish');
                                } // end of if for checking redirect_app
                                else {
                                    if ($scope.status === 1 || $scope.first_name == null ) {
                                        document.getElementById("overlay").style.display = "none";
                                        if ($scope.user_type === true)
                                            $state.go('proDeclaration');
                                        else
                                            $state.go('declaration');
                                    } // end of if when information of user is not present
                                    else {
                                        document.getElementById("overlay").style.display = "none";
                                        if ($scope.myDetails.first_name !== "") {
                                            $scope.FirstName = $scope.myDetails.first_name;
                                            $rootScope.FirstName = $scope.FirstName;
                                        }
                                        if ($scope.myDetails.last_name !== "") {
                                            $scope.LastName = $scope.myDetails.last_name;
                                            $rootScope.LastName = $scope.LastName;
                                        }
                                        if ($scope.myDetails.address_line_1 !== "") {
                                            $scope.AddressLine1 = $scope.myDetails.address_line_1;
                                            $rootScope.AddressLine1 = $scope.AddressLine1;
                                        }
                                        if ($scope.myDetails.address_line_2 !== "") {
                                            $scope.AddressLine2 = $scope.myDetails.address_line_2;
                                            $rootScope.AddressLine2 = $scope.AddressLine2;
                                        }
                                        if ($scope.myDetails.city !== "") {
                                            $scope.City = $scope.myDetails.city;
                                            $rootScope.City = $scope.City;
                                        }
                                        if ($scope.myDetails.state !== "") {
                                            $scope.State = $scope.myDetails.state;
                                            $rootScope.State = $scope.State;
                                        }
                                        if ($scope.myDetails.country !== "") {
                                            $scope.Country = $scope.myDetails.country;
                                            $rootScope.Country = $scope.Country;
                                        }
                                        if ($scope.myDetails.zip !== "") {
                                            $scope.Zip = $scope.myDetails.zip;
                                            $rootScope.Zip = $scope.Zip;
                                        }
                                        if ($scope.myDetails.phone !== "") {
                                            $scope.PhoneNumber = $scope.myDetails.phone;
                                            $rootScope.PhoneNumber = $scope.PhoneNumber;
                                        }
                                        if ($scope.myDetails.email !== "") {
                                            $scope.Email = $scope.myDetails.email;
                                            $rootScope.Email = $scope.Email;
                                        }
                                        if ($scope.myDetails.OCCUPATION !== "") {
                                            $scope.Occupation = $scope.myDetails.OCCUPATION;
                                            $rootScope.Occupation = $scope.Occupation;
                                        }
                                        if ($scope.myDetails.title !== "") {
                                            $scope.Title = $scope.myDetails.title;
                                            $rootScope.Title = $scope.Title;
                                        }
                                        if ($scope.myDetails.employer_name !== "" && $scope.myDetails.employer_name !== undefined) {
                                            $scope.Employer = $scope.myDetails.employer_name;
                                            $rootScope.Employer = $scope.Employer;
                                        }
                                        if ($scope.myDetails.employer_address !== "" && $scope.myDetails.employer_address !== undefined) {
                                            $scope.EmployerAddress = $scope.myDetails.employer_address;
                                            $rootScope.EmployerAddress = $scope.EmployerAddress;
                                        }
                                        if ($scope.myDetails.employer_city !== "" && $scope.myDetails.employer_city !== undefined) {
                                            $scope.EmployerCity = $scope.myDetails.employer_city;
                                            $rootScope.EmployerCity = $scope.EmployerCity;
                                        }
                                        if ($scope.myDetails.employerState !== "" && $scope.myDetails.employerState !== undefined) {
                                            $scope.EmployerState = $scope.myDetails.employerState;
                                            $rootScope.EmployerState = $scope.EmployerState;
                                        }
                                        if ($scope.myDetails.employer_zip !== "" && $scope.myDetails.employer_zip !== undefined) {
                                            $scope.EmployerZip = $scope.myDetails.employer_zip;
                                            $rootScope.EmployerZip = $scope.EmployerZip;
                                        }
                                        if ($scope.myDetails.employer_country !== "" && $scope.myDetails.employer_country !== undefined) {
                                            $scope.EmployerCountry = $scope.myDetails.employer_country;
                                            $rootScope.EmployerCountry = $scope.EmployerCountry;
                                        }
                                        if ($scope.myDetails.is_self_employed !== "" && $scope.myDetails.is_self_employed !== undefined) {
                                            $scope.RetiredOrEmplyedStatus = $scope.myDetails.is_self_employed;
                                            $rootScope.RetiredOrEmplyedStatus = $scope.RetiredOrEmplyedStatus;
                                        }
                                        if ($scope.myDetails.employee_function !== "") {
                                            $scope.EmploymentFunctionEmployer = $scope.myDetails.employee_function;
                                            $rootScope.EmploymentFunctionEmployer = $scope.EmploymentFunctionEmployer;
                                        }
                                        redirectToScreen();
                                    } // end of else for checking if info is already present.
                                } // end of else for checking redirect_app
                            }, // end of service then function
                                function myError(response) {
                                    document.getElementById("overlay").style.display = "none";
                                    alert(response.data.error + ". If you need any assistance, please contact " + $rootScope.firmName + " at " + $rootScope.firmMail + ".");
                                });
                    } // username required if
                }; // end of function

                $scope.loginWithUsername = loginWithUsername;

                window.onafterprint = (event) => {
                    $rootScope.redirectToScreen();
                };

                var redirectToScreen = function () {
                    if($rootScope.proUserCheck === true)
                    {
                        if ($rootScope.showCTA === true) {
                            $state.go('CTA');
                        }
                        else if ($rootScope.showNASDAQpro === true) {
                            $state.go('nasdaqAgreement');
                        }
                        else if ($rootScope.showOTCpro === true) {
                            $state.go('marketDataSubscriberAgreement');
                        }
                        else if ($rootScope.showOPRApro === true) {
                            $state.go('opraPro');
                        }
                        else  {
                            $state.go('finish');
                        } 
                    }
                    else
                    {
                        if ($rootScope.showNASDAQ === true) {
                            $state.go('nasdaqAgreement');
                        }
                        else if ($rootScope.showNYSE === true) {
                            $state.go('nyseAgreement');
                        } else if ($rootScope.showOTC === true) {
                            $state.go('marketDataSubscriberAgreement');
                        } else if ($rootScope.showOPRA === true) {
                            $state.go('Opra');
                        } else if ($rootScope.showBATS === true) {
                            $state.go('batScreen');
                        } else if ($rootScope.showCME === true) {
                            $state.go('cme');
                        } else if ($rootScope.showTSX === true) {
                            $state.go('TSX');
                        } else if ($rootScope.showCTA=== true) {
                            $state.go('CTA');
                        } 
                        else {
                            $state.go('finish');
                        }
                    }
                };

                $rootScope.redirectToScreen = redirectToScreen;
                var saveUserForm = function () {
                    document.getElementById("overlay").style.display = "block";
                    var checkFields = false;
                    if ($scope.RetiredOrEmplyedStatus == 'true') {
                        if ($scope.FirstName !== "" && $scope.FirstName !== undefined &&
                            $scope.LastName !== "" && $scope.LastName !== undefined &&
                            $scope.AddressLine1 !== "" && $scope.AddressLine1 !== undefined &&
                            $scope.City !== "" && $scope.City !== undefined &&
                            $scope.State !== "" && $scope.State !== undefined &&
                            $scope.Country !== "" && $scope.Country !== undefined &&
                            $scope.Zip !== "" && $scope.Zip !== undefined &&
                            $scope.PhoneNumber !== "" && $scope.PhoneNumber !== undefined &&
                            $scope.Email !== "" && $scope.Email !== undefined &&
                            $scope.RetiredOrEmplyedStatus !== "" && $scope.RetiredOrEmplyedStatus !== undefined
                        ) {
                            checkFields = true;
                        } else {
                            document.getElementById("overlay").style.display = "none";
                            checkFields = false;
                        }
                    } else {
                        if ($scope.FirstName !== "" && $scope.FirstName !== undefined &&
                            $scope.LastName !== "" && $scope.LastName !== undefined &&
                            $scope.AddressLine1 !== "" && $scope.AddressLine1 !== undefined &&
                            $scope.City !== "" && $scope.City !== undefined &&
                            $scope.State !== "" && $scope.State !== undefined &&
                            $scope.Country !== "" && $scope.Country !== undefined &&
                            $scope.Zip !== "" && $scope.Zip !== undefined &&
                            $scope.PhoneNumber !== "" && $scope.PhoneNumber !== undefined &&
                            $scope.Email !== "" && $scope.Email !== undefined &&
                            $scope.RetiredOrEmplyedStatus !== "" && $scope.RetiredOrEmplyedStatus !== undefined &&
                            $scope.Employer !== "" && $scope.Employer !== undefined &&
                            $scope.EmployerAddress !== "" && $scope.EmployerAddress !== undefined &&
                            $scope.EmployerCity !== "" && $scope.EmployerCity !== undefined &&
                            $scope.EmployerState !== "" && $scope.EmployerState !== undefined &&
                            $scope.EmployerCountry !== "" && $scope.EmployerCountry !== undefined &&
                            $scope.EmployerZip !== "" && $scope.EmployerZip !== undefined &&
                            $scope.Title !== "" && $scope.Title !== undefined &&
                            $scope.EmploymentFunctionEmployer !== "" && $scope.EmploymentFunctionEmployer !== undefined
                        ) {
                            checkFields = true;
                        } else {
                            document.getElementById("overlay").style.display = "none";
                            checkFields = false;
                        }
                    }
                    if (checkFields === true) {
                        document.getElementById("overlay").style.display = "none";
                        var RetiredOrEmplyedStatus;
                        if ($scope.RetiredOrEmplyedStatus == 'true') {
                            RetiredOrEmplyedStatus = true;
                        } else {
                            RetiredOrEmplyedStatus = false;
                        }
                        $rootScope.Title = $scope.Title;
                        $rootScope.AddressLine2 = $scope.AddressLine2;
                        $rootScope.FirstName = $scope.FirstName;
                        $rootScope.LastName = $scope.LastName;
                        $rootScope.AddressLine1 = $scope.AddressLine1;
                        $rootScope.City = $scope.City;
                        $rootScope.State = $scope.State;
                        $rootScope.Country = $scope.Country;
                        $rootScope.Zip = $scope.Zip;
                        $rootScope.PhoneNumber = $scope.PhoneNumber;
                        $rootScope.Email = $scope.Email;
                        $rootScope.Occupation = $scope.Occupation;
                        $rootScope.RetiredOrEmplyedStatus = $scope.RetiredOrEmplyedStatus;
                        $rootScope.Employer = $scope.Employer;
                        $rootScope.EmployerAddress = $scope.EmployerAddress;
                        $rootScope.EmployerCity = $scope.EmployerCity;
                        $rootScope.EmployerState = $scope.EmployerState;
                        $rootScope.EmployerCountry = $scope.EmployerCountry;
                        $rootScope.EmployerZip = $scope.EmployerZip;
                        $rootScope.EmploymentFunctionEmployer = $scope.EmploymentFunctionEmployer;
                        $rootScope.USscubNonProCheckbox =  $rootScope.proUserCheck ? false: true;
                        $rootScope.USscubProCheckbox =  $rootScope.proUserCheck ? true: false;
                        $rootScope.IndividualSubscriberCheckbox = true;
                    }
                    headers = {
                        "firm_code": $rootScope.firmcode,
                        "token": $rootScope.token
                    };
                    var req = {
                        method: 'POST',
                        url: "//www6.quodd.com/vor/quodd/app/user/agreement",
                        headers: headers,
                        data: {
                            "first_name": $rootScope.FirstName,
                            "last_name": $rootScope.LastName,
                            "address_line_1": $rootScope.AddressLine1,
                            "address_line_2": $rootScope.AddressLine2,
                            "city": $rootScope.City,
                            "state": $rootScope.State,
                            "zip": $rootScope.Zip,
                            "country": $rootScope.Country,
                            "email": $rootScope.Email,
                            "phone": $rootScope.PhoneNumber,
                            "title": $rootScope.Title,
                            "employer_name": $rootScope.Employer,
                            "employer_address": $rootScope.EmployerAddress,
                            "employer_city": $rootScope.EmployerCity,
                            "employer_state": $rootScope.EmployerState,
                            "employer_zip": $rootScope.EmployerZip,
                            "employer_country": $rootScope.EmployerCountry,
                            "is_self_employed": true,
                            "employee_function": $rootScope.EmploymentFunctionEmployer
                        }
                    };
                    $http(req).then(function (response) {
                        redirectToScreen();
                    });
                };

                $rootScope.callAgreementFilledScreen = saveUserForm;

                var callInfoScreen = function () {
                    document.getElementById("overlay").style.display = "block";
                    $scope.RetiredOrEmplyedStatus = 'false';
                    $rootScope.RetiredOrEmplyedStatus = $scope.RetiredOrEmplyedStatus;
                    document.getElementById("overlay").style.display = "none";
                    $state.go('information');
                };

                $rootScope.callInfoScreen = callInfoScreen;

                var callAgreementForMarketDataDisplay = function () {
                    headers = {
                        "firm_code": $rootScope.firmcode,
                        "token": $rootScope.token
                    };
                    var req = {
                        method: 'POST',
                        url: "//www6.quodd.com/vor/quodd/app/user/agreement/" + 1 + "/accept",
                        headers: headers,
                        data: {}
                    };
                    $http(req).then(function (response) {
                        $scope.AgreementAcceptanceStatus = response.data.status;
                        if ($scope.AgreementAcceptanceStatus === "SUCCESS") {
                            // console.log("agreement saved");
                            $rootScope.showNYSE = false;
                        } else {
                            console.log("Problem saving agreements");
                        }
                    });
                    $scope.NyseInfoFlagCHeck = true;
                    if ($scope.NyseInfoFlagCHeck === true) {
                        $state.go('marketDataAgreement');
                        $rootScope.NYSEnameField = $scope.NYSEnameField;
                        $rootScope.NYSEtitleField = $scope.NYSEtitleField;
                        $rootScope.NYSEempFunctionField = $scope.NYSEempFunctionField;
                        if ($scope.NYSEradio1 === "true") {
                            $rootScope.NYSEradio1Val = "true";
                        }
                        if ($scope.NYSEradio1 === "false") {
                            $rootScope.NYSEradio1Val = "false";
                        }
                        if ($scope.NYSEradio2 === "true") {
                            $rootScope.NYSEradio2Val = "true";
                        }
                        if ($scope.NYSEradio2 === "false") {
                            $rootScope.NYSEradio2Val = "false";
                        }
                    }
                };

                $rootScope.callAgreementForMarketDataDisplay = callAgreementForMarketDataDisplay;

                var callMarketDataSubscriberAgreementFilled = function () {
                    headers = {
                        "firm_code": $rootScope.firmcode,
                        "token": $rootScope.token
                    };
                    var req = {
                        method: 'POST',
                        url: $rootScope.proUserCheck ?"//www6.quodd.com/vor/quodd/app/user/agreement/" + 12 + "/accept"  :"//www6.quodd.com/vor/quodd/app/user/agreement/" + 3 + "/accept",
                        headers: headers,
                        data: {}
                    };
                    $http(req).then(function (response) {
                        $scope.AgreementAcceptanceStatus = response.data.status;
                        if ($scope.AgreementAcceptanceStatus === "SUCCESS") {
                            // console.log("agreement saved");
                           if($rootScope.proUserCheck){$rootScope.showOTCpro = false;}
                           else {$rootScope.showOTC=false}

                        } else {
                            console.log("Problem saving agreements");
                        }
                    });
                    $state.go('marketDataSubscriberAgreementFilled');
                };

                $rootScope.callMarketDataSubscriberAgreementFilled = callMarketDataSubscriberAgreementFilled;

                $rootScope.callOpraScreenFilled = function () {
                    headers = {
                        "firm_code": $rootScope.firmcode,
                        "token": $rootScope.token
                    };
                    var req = {
                        method: 'POST',
                        url: "//www6.quodd.com/vor/quodd/app/user/agreement/" + 4 + "/accept",
                        headers: headers,
                        data: {}
                    };
                    $http(req).then(function (response) {
                        $scope.AgreementAcceptanceStatus = response.data.status;
                        if ($scope.AgreementAcceptanceStatus === "SUCCESS") {
                            // console.log("agreement saved");
                            $rootScope.showOPRA = false;
                        } else {
                            console.log("Problem saving agreements");
                        }
                    });
                    $state.go('OpraFilled');
                };

                var callBatScreenFilled = function () {
                    headers = {
                        "firm_code": $rootScope.firmcode,
                        "token": $rootScope.token
                    };
                    var req = {
                        method: 'POST',
                        url: "//www6.quodd.com/vor/quodd/app/user/agreement/" + 5 + "/accept",
                        headers: headers,
                        data: {}
                    };
                    $http(req).then(function (response) {
                        $scope.AgreementAcceptanceStatus = response.data.status;
                        if ($scope.AgreementAcceptanceStatus === "SUCCESS") {
                            // console.log("agreement saved");
                            $rootScope.showBATS = false;
                        } else {
                            console.log("Problem saving agreements");
                        }
                    });
                    $state.go('batScreenFilled');
                };

                $rootScope.callBatScreenFilled = callBatScreenFilled;

                var callTSXScreenFilled = function () {
                    headers = {
                        "firm_code": $rootScope.firmcode,
                        "token": $rootScope.token
                    };
                    var req = {
                        method: 'POST',
                        url: "//www6.quodd.com/vor/quodd/app/user/agreement/" + 7 + "/accept",
                        headers: headers,
                        data: {}
                    };
                    $http(req).then(function (response) {
                        $scope.AgreementAcceptanceStatus = response.data.status;
                        if ($scope.AgreementAcceptanceStatus === "SUCCESS") {
                            // console.log("TSX agreement saved");
                            $rootScope.showTSX = false;
                        } else {
                            console.log("Problem saving agreements");
                        }
                    });
                    $state.go('TSXFilled');
                };

                $rootScope.callTSXScreenFilled = callTSXScreenFilled;

                var callCMEScreenFilled = function () {
                    headers = {
                        "firm_code": $rootScope.firmcode,
                        "token": $rootScope.token
                    };
                    var req = {
                        method: 'POST',
                        url: "//www6.quodd.com/vor/quodd/app/user/agreement/" + 6 + "/accept",
                        headers: headers,
                        data: {}
                    };
                    $http(req).then(function (response) {
                        $scope.AgreementAcceptanceStatus = response.data.status;
                        if ($scope.AgreementAcceptanceStatus === "SUCCESS") {
                            // console.log("agreement saved");
                            $rootScope.showCME = false;
                        } else {
                            console.log("Problem saving agreements");
                        }
                    });
                    $state.go('cmeFilled');
                };

                $rootScope.callCMEScreenFilled = callCMEScreenFilled;

                $scope.callNasdaqAgreementFilledScreen = function () {
                    document.getElementById("overlay").style.display = "block";
                    headers = {
                        "firm_code": $rootScope.firmcode,
                        "token": $rootScope.token
                    };
                    var req = {
                        method: 'POST',
                        url: $rootScope.proUserCheck ? "//www6.quodd.com/vor/quodd/app/user/agreement/" + 11 + "/accept":"//www6.quodd.com/vor/quodd/app/user/agreement/" + 2 + "/accept",
                        headers: headers,
                        data: {}
                    };
                    $http(req).then(function (response) {
                        $scope.AgreementAcceptanceStatus = response.data.status;
                        if ($scope.AgreementAcceptanceStatus === "SUCCESS") {
                            // console.log("agreement saved");
                            if($rootScope.proUserCheck){$rootScope.showNASDAQpro = false;}
                           else {$rootScope.showNASDAQ = false}
                        } else {
                            console.log("Problem saving agreements");
                        }
                    });
                    document.getElementById("overlay").style.display = "none";
                    $state.go('agreementFilled');
                };

                //code for cta
                $rootScope.callCTAScreenFilled = function () {
                    headers = {
                        "firm_code": $rootScope.firmcode,
                        "token": $rootScope.token
                    };
                    var req = {
                        method: 'POST',
                        url: "//www6.quodd.com/vor/quodd/app/user/agreement/" + 10 + "/accept",
                        headers: headers,
                        data: {}
                    };
                    $http(req).then(function (response) {
                        $scope.AgreementAcceptanceStatus = response.data.status;
                        if ($scope.AgreementAcceptanceStatus === "SUCCESS") {
                            // console.log("agreement saved");
                            $rootScope.showCTA = false;
                        } else {
                            console.log("Problem saving agreements");
                        }
                    });
                    $state.go('CTAFilled');
                };

                // for opra pro
                $rootScope.callOpraProFilled = function () {
                    headers = {
                        "firm_code": $rootScope.firmcode,
                        "token": $rootScope.token
                    };
                    var req = {
                        method: 'POST',
                        url: "//www6.quodd.com/vor/quodd/app/user/agreement/" + 9 + "/accept",
                        headers: headers,
                        data: {}
                    };
                    $http(req).then(function (response) {
                        $scope.AgreementAcceptanceStatus = response.data.status;
                        if ($scope.AgreementAcceptanceStatus === "SUCCESS") {
                            // console.log("agreement saved");
                            $rootScope.showOPRApro = false;
                        } else {
                            console.log("Problem saving agreements");
                        }
                    });
                    $state.go('opraProFilled');
                };

            });
    </script>
    <style type="text/css">
        .scrollThisContent {
            height: 600px;
            overflow: auto;
            border-color: #337ab7;
            border-style: solid;
            border-width: 1px;
            border-radius: 5px;
            width: 100%;
        }

        .linkClass {
            text-decoration: underline;
            color: blue;
        }

        .FixedHeightContainer {
            height: 625px;
            padding: 10px;
        }

        .markText {
            background-color: yellow;
        }
    </style>
    <style type="text/css" media="print">
        @page {
            size: auto;
            margin: 0mm;
        }

        @media print {
            body {
                margin: 1.6cm;
            }
            .scrollThisContent {
                height: 100%;
                width: 100%;
                overflow: visible;
            }
        }
    </style>
    <style type="text/css">
        #loader {
            position: absolute;
            left: 50%;
            display: block;
            top: 50%;
            z-index: 1;
            width: 150px;
            height: 150px;
            margin: -75px 0 0 -75px;
            border: 16px solid #f3f3f3;
            border-radius: 50%;
            border-top: 16px solid #3498db;
            width: 120px;
            height: 120px;
            -webkit-animation: spin 2s linear infinite;
            animation: spin 2s linear infinite;
        }

        @-webkit-keyframes spin {
            0% {
                -webkit-transform: rotate(0deg);
            }
            100% {
                -webkit-transform: rotate(360deg);
            }
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }

        .animate-bottom {
            position: relative;
            -webkit-animation-name: animatebottom;
            -webkit-animation-duration: 1s;
            animation-name: animatebottom;
            animation-duration: 1s
        }

        @-webkit-keyframes animatebottom {
            from {
                bottom: -100px;
                opacity: 0
            }
            to {
                bottom: 0px;
                opacity: 1
            }
        }

        @keyframes animatebottom {
            from {
                bottom: -100px;
                opacity: 0
            }
            to {
                bottom: 0;
                opacity: 1
            }
        }

        #overlay {
            background: #e9e9e9;
            display: none;
            position: absolute;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            opacity: 0.5;
        }
    </style>
</head>

<body ng-app="quoddAgreementApp" ng-controller="quoddAgreementController">
    <div id="overlay">
        <div id="loader"></div>
    </div>
    <br>
    <br>
    <div ui-view></div>
</body>

</html>